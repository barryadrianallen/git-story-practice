This is chapter 2, with better ideas